
<html>
<head>
    <title>WEB-сольфеджио</title>
</head>
<body>

<h1>«Вечерняя песня» («Город над вольной Невой») , созданной в 1957 году композитором Василием Соловьёвым-Седым на стихи Александра Чуркина.</h1>

<h3>Ноты мелодии:</h3>
<ul>
    <li><button onclick="playSound(octava['E4'], 1000)">E4</button></li>
    <li><button onclick="playSound(octava['C4'], 1000)">C4</button></li>
    <li><button onclick="playSound(octava['D4'], 1000)">D4</button></li>
    <li><button onclick="playSound(octava['E4'], 1000)">E4</button></li>
    <li><button onclick="playSound(octava['A4'], 1000)">A4</button></li>
    <li><button onclick="playSound(octava['G#4'], 1000)">G#4</button></li>
    <li><button onclick="playSound(octava['E4'], 1000)">E4</button></li>
</ul>

<h3>Проиграть всю мелодию</h3>
<button onclick="playMelody()">Play Melody</button><br><br>

<script>
const octava = {
    'C4': 261.63,
    'C#4': 277.18,
    'D4': 293.66,
    'D#4': 311.13,
    'E4': 329.63,
    'F4': 349.23,
    'F#4': 369.99,
    'G4': 392.00,
    'G#4': 415.30,
    'A4': 440.00,
    'A#4': 466.16,
    'B4': 493.88,
    'P': 0 // Пауза
};

async function playSound(freq, dur) {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    const oscillator = audioContext.createOscillator();
    oscillator.type = 'sine';
    oscillator.frequency.value = freq;
    oscillator.connect(audioContext.destination);
    oscillator.start();
    await new Promise(resolve => setTimeout(resolve, dur));
    oscillator.stop();
};

async function playMelody() {
    const melody = ['E4', 1000, 'C4', 750, 'D4', 250, 'E4', 1000, 'A4', 750, 'G#4', 250, 'E4', 3000];
    for (let i = 0; i < melody.length; i += 2) {
        await playSound(octava[melody[i]], melody[i + 1]);
    }
};
</script>

</body>
</html>
